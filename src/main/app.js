'use strict';

const { div, h1, p } = require('@chaffity/fui/html');
const { svg, g, path } = require('@chaffity/fui/svg');
const { hexagon, square, squiggle, triangle } = require('@emphori/fui-shapes');

const root =
  div.attr('class', 'container vertical');

const logo = 
  div.attr('class', 'logo').add(
    svg.attr('width', '54px').attr('height', '54px').attr('viewBox', '0 0 54 54').attr('version', '1.1').attr('xmlns', 'http://www.w3.org/2000/svg').attr('xmlns:xlink', 'http://www.w3.org/1999/xlink').add(
      g.attr('transform', 'translate(-120, -112)').attr('fill', '#D50091').add(
        path.attr('d', 'M150.067476,112 C156.93507,112 160.509198,112.928256 163.768457,114.671327 C167.027716,116.414398 169.585602,118.972284 171.328673,122.231543 C173.071744,125.490802 174,129.06493 174,135.932524 L174,142.067476 C174,148.93507 173.071744,152.509198 171.328673,155.768457 C169.585602,159.027716 167.027716,161.585602 163.768457,163.328673 C160.509198,165.071744 156.93507,166 150.067476,166 L143.932524,166 C137.06493,166 133.490802,165.071744 130.231543,163.328673 C126.972284,161.585602 124.414398,159.027716 122.671327,155.768457 C120.928256,152.509198 120,148.93507 120,142.067476 L120,135.932524 C120,129.06493 120.928256,125.490802 122.671327,122.231543 C124.414398,118.972284 126.972284,116.414398 130.231543,114.671327 C133.490802,112.928256 137.06493,112 143.932524,112 L150.067476,112 Z M150.301011,127.220538 C149.741097,127.168354 149.161689,127.184349 148.562772,127.268521 C147.250859,127.452898 146.110505,127.874909 145.141678,128.534566 C144.172851,129.194223 143.348292,130.000823 142.667978,130.954388 C141.987664,131.907954 141.431343,132.967682 140.998997,134.133605 C140.566652,135.299528 140.250395,136.463661 140.050217,137.626038 C139.850038,138.788416 139.738543,139.909229 139.715727,140.988514 C139.692912,142.067798 139.737618,143.006704 139.849848,143.80526 C140.022201,145.031614 140.347747,146.054652 140.826495,146.874406 C141.305244,147.694159 141.875016,148.333881 142.535829,148.79359 C143.196642,149.253299 143.922963,149.55838 144.714813,149.708841 C145.506663,149.859302 146.316114,149.876414 147.14319,149.760176 C147.998786,149.63993 148.807698,149.446267 149.569949,149.179182 C150.3322,148.912097 150.998977,148.534831 151.570299,148.047372 C152.167327,147.537921 152.573785,147.140044 152.813628,146.425608 L152.813628,146.425608 L152.838018,146.305278 C152.865762,146.103368 152.829205,145.896668 152.731813,145.715269 C152.478774,145.243967 151.891578,145.06703 151.420275,145.320069 L151.420275,145.320069 L151.128551,145.46832 C150.43337,145.802258 149.637079,146.052931 148.739677,146.220338 C147.370724,146.412732 146.360095,146.205774 145.707761,145.599457 C145.055427,144.99314 144.627057,143.962741 144.422638,142.508228 L144.422638,142.508228 L144.329448,141.845144 C144.299386,141.631245 144.282583,141.408216 144.279037,141.176049 C147.567763,140.36485 150.055158,139.077351 151.741298,137.313513 C153.427438,135.549674 154.10015,133.455692 153.759452,131.031504 C153.635198,130.147388 153.404653,129.438179 153.06781,128.903856 C152.730967,128.369532 152.325605,127.968449 151.851713,127.700594 C151.377821,127.432738 150.860925,127.272721 150.301011,127.220538 Z M149.24239,129.31061 C149.926867,129.214413 150.388843,129.345795 150.628333,129.70476 C150.867823,130.063724 151.021635,130.485619 151.089775,130.970457 C151.362333,132.909808 150.877811,134.635619 149.636196,136.147943 C148.39458,137.660267 146.602018,138.770138 144.258456,139.477584 C144.301775,138.337252 144.438784,137.19104 144.669486,136.038914 C144.900188,134.886789 145.217216,133.831608 145.620579,132.873341 C146.023942,131.915073 146.528775,131.109784 147.135091,130.45745 C147.741408,129.805116 148.443834,129.42284 149.24239,129.31061 Z')
      )
    )
  );

const heading =
  div.attr('class', 'box')
    .add(h1.attr('class', 'underline').text('Emphori.'))
    .add(p.attr('class', 'italic').text('Software consultancy and open source<br>development for the modern web.'));
  
const app =  root
  .add(logo)
  .add(heading);

const shapes = [
  hexagon, 
  square,
  squiggle,
  triangle,
];

const points = [];
let failures = 0;

while (failures < 100) {
  const x = Math.floor(Math.random() * innerWidth);
  const y = Math.floor(Math.random() * innerHeight);

  if (points.every((point) => distanceBetweenPoints(...point, x, y) > 200)) {
    points.push([x, y]);
  } else {
    failures++;
  }
}

for (const [x, y] of points) {
  const elem = shapes[Math.floor(Math.random() * shapes.length)]
    .attr('opacity', 0.3)
    .attr('style', `position: absolute; left: ${x}px; top: ${y}px; z-index: 999;`)
    .attr('transform', `rotate(${Math.floor(Math.random() * 360)})`);

  document.body.appendChild(elem());
}

document.body.appendChild(app());

function distanceBetweenPoints(x1, y1, x2, y2) {
  return Math.sqrt(Math.pow(x1 - x2, 2) + Math.pow(y1 - y2, 2))
}
